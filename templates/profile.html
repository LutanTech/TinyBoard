{% extends "layout.html" %}
{% block title %}Profile {% endblock %}

{% block content %}
<div class="container flex row wrap ">
  {% if dest %}
  {% if dest == 'edit' %}
  <script>
document.addEventListener('DOMContentLoaded', ()=>{
    document.getElementById('add_notification').classList.add('none')
})
  </script>
  {% elif dest == 'notifications' %}
  <script >
document.addEventListener('DOMContentLoaded', ()=>{
    document.getElementById('update_teacher').classList.add('none')
})
  </script>  
  {% else %}
  <script >
document.addEventListener('DOMContentLoaded', ()=>{
    document.getElementById('update_teacher').classList.remove('none');
      document.getElementById('add_notification').classList.remove('none');
    });
    </script>
    {% endif %}  
    {% endif %}  
  <div id="update_teacher" class="flex grow mnw-300 col jst-cn mg-au bx-shd-0510 pd-10 bdr-5" style="width:90% !important; max-width: 500px;">
  <form action="/update_teacher" class="form div flex col jst-cn aln-cn bg-gr-0 mg-5" method="POST" >
  <img class="profile-pic ar-1" style="width: 50px !important;" src="{{teacher.pic}}">
    <p class="cl-bl bldr f-s-l">{{teacher.name}}</p>
    <input type="tel" name="phone" id="phone" class="input f-s-s" placeholder="Enter New Phone Number" value="{{teacher.phone1}}">
    <input type="email" name="email" id="email" class="input f-s-s" placeholder="Enter New Email" value="{{teacher.email}}">
    <input type="file" name="pic-input" id="pic-input" class="input f-s-s bd-1" >
    <button type="submit" class="mg-5 bdr-40 pd-10 bg-b-0 cl-w">Update</button>
  </form>

  <form id="change-class-form" class="div form  grow" style="background: rgb(255, 167, 167);">
    <input type="text" class="input f-s-s" name="new_grade" placeholder="Enter new grade or class or Stream" required>
    <button type="submit" class="mg-5 bdr-40 pd-10 bg-b-0 cl-w">Change Class</button>
  </form>
</div>

<!-- notification -->

<!-- ++++++++++++++++++++++++++++++++============ -->

  <form id="add_notification" class="div form mg-5 grow col jst-cn aln-cn form div bx-shd-0500 bg-bl-0" action="add_notification" method="POST">
     <input type="text" name="title" id="title" class="input f-s-s" placeholder="Enter Notification Name" required><br>
     <label for="priority" class="cl-w">Priority</label><br>
     <select name="priority" id="priority" class="bd-1 input f-s-s" required>
      <option value="">--select--</option>
      <option value="low">Low</option>
      <option value="medium">Medium</option>
      <option value="high">High</option>
     </select>
     <textarea name="content" id="content" rows="4" style="min-height: 3em; max-height: 20em;" class="bd-1 input f-s-s" placeholder="Enter Notification text" required></textarea>
     <input type="text" name="date" id="date">
    <button type="submit" class="mg-5 bdr-40 pd-10 bg-b-0 cl-w">Add Notification</button>
  </form>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', ()=>{
      const form = document.getElementById('add_notification')
      form.addEventListener('submit', (e)=>{
            e.preventDefault()
      let today = new Date()
      let formatedDate = today.toLocaleDateString()
      let formatedTime = today.toLocaleTimeString()
      document.getElementById('date').value = `${formatedDate} at ${formatedTime} `;
      setTimeout(() => {
      form.submit()
      }, 1000);
      })

    })

  document.getElementById("change-class-form").addEventListener("submit", function(e) {
    e.preventDefault();
    const formData = new FormData(this);
  
    fetch("/change_class/{{ teacher.id }}", {
      method: "POST",
      body: formData
    })
    .then(res => res.json())
    .then(data => {
      if (data.status === 'success') {
        new swal("Success!", data.message, "success");
      } else {
        swal("Oops!", data.message, "error");
      }
    })
    .catch(err => {
      new swal("Error!", "Something went wrong.", "error");
    });
  });
  </script>
  {% endblock %}